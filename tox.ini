[tox]
env_list = py{310,311}
isolated_build = True

[gh-actions]
python =
    3.10: py310
    3.11: py311

[testenv]
deps =
    pytest>=7.0
    pytest-cov>=4.0
    pytest-mock>=3.10
    requests>=2.31
    python-dotenv>=1.0
commands =
    pytest {posargs:tests} --cov=ib_cicd --cov-report=term-missing

[coverage:run]
source = ib_cicd
omit =
    */__init__.py
    */test_*.py

[testenv:regression]
passenv =
    SOURCE_HOST_URL
    TARGET_HOST_URL
    SOURCE_TOKEN
    TARGET_TOKEN
deps =
    pytest>=7.0
    pytest-cov>=4.0
    pytest-mock>=3.10
    requests>=2.31
    python-dotenv>=1.0
commands =
    pytest {posargs:regression/test_regression.py} -v
